metricsets: ["query"]
hosts: 
  - sqlserver://{{username}}:{{password}}@{{hosts}}   # Need to use this format
period: {{period}}
raw_data.enabled: true
# Below dynamic_counter_name handles the dynamic counter name passing it to SQL query
dynamic_counter_name: {{dynamic_counter_name}}
driver: "mssql"
# Below TRIM() will remove the trailing spaces which is coming from SQL DB value
sql_queries:
  - query: "SELECT TRIM(counter_name) As 'User_Connections',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name= 'User Connections'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Active_temp_tables',cntr_value FROM  sys.dm_os_performance_counters WHERE counter_name = 'Active Temp Tables' AND object_name like '%General Statistics%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Buffer cache hit ratio',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Buffer cache hit ratio' AND object_name like '%Buffer Manager%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Page splits/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Page splits/sec'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Lock Waits/sec' ,cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Lock Waits/sec' AND instance_name = '_Total'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'SQL Compilations/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'SQL Compilations/sec'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Batch Requests/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Batch Requests/sec'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Checkpoint pages/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Checkpoint pages/sec' AND object_name like '%Buffer Manager%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Database pages',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Database pages' AND object_name like '%Buffer Manager%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Page life expectancy',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Page life expectancy' AND  object_name like '%Buffer Manager%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Target pages',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Target pages' AND  object_name like '%Buffer Manager%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Connection Reset/sec',cntr_value FROM  sys.dm_os_performance_counters WHERE counter_name = 'Connection Reset/sec' AND object_name like '%Buffer Manager%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Logins/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Logins/sec' AND object_name like '%General Statistics%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Logouts/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Logouts/sec' AND object_name like '%General Statistics%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'Transactions',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'Transactions' AND object_name like '%General Statistics%'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As 'SQL Re-Compilations/sec',cntr_value FROM sys.dm_os_performance_counters WHERE counter_name = 'SQL Re-Compilations/sec'"
    response_format: variables
  - query: "SELECT TRIM(counter_name) As '{{dynamic_counter_name}}' ,cntr_value FROM sys.dm_os_performance_counters WHERE counter_name= '{{dynamic_counter_name}}'"
    response_format: variables

 
